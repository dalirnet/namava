"use strict";!function i(r,o,s){function d(n,e){if(!o[n]){if(!r[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(c)return c(n,!0);throw new Error("Cannot find module '"+n+"'")}var a=o[n]={exports:{}};r[n][0].call(a.exports,function(e){var t=r[n][1][e];return d(t||e)},a,a.exports,i,r,o,s)}return o[n].exports}for(var c="function"==typeof require&&require,e=0;e<s.length;e++)d(s[e]);return d}({1:[function(e,t,n){$(document).ready(function(){var o={data:{},number:function(e,t){var n=1<arguments.length&&void 0!==t?t:"fa",a={fa:["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"],en:["0","1","2","3","4","5","6","7","8","9"]};if(e=e.toString(),"fa"==n){for(var i=0;i<10;i++)e=e.replace(new RegExp(a.en[i],"g"),a.fa[i]);return e}for(i=0;i<10;i++)e=e.replace(new RegExp(a.fa[i],"g"),a.en[i]);return e.toString()},mediaTemplate:$("#mediaTemplate").html(),template:function(){Mustache.parse(o.mediaTemplate),o.render(),$("#list").on("click",".watchAction",function(e){"watch"==$(e.currentTarget).attr("data-type")?o.watch.add($(e.currentTarget).attr("data-id"),e.currentTarget):o.watch.remove($(e.currentTarget).attr("data-id"),e.currentTarget),iziToast.show({message:["وضعیت","' "+$(e.currentTarget).attr("data-name")+" '","آپدیت شد"].join(" ")})}).on("click",".updateMediaAction",function(e){o.addMedia($(e.currentTarget).attr("data-id"))}).on("click",".removeMediaAction",function(e){o.removeMedia($(e.currentTarget).attr("data-id"))}).on("click",".watchAllAction",function(e){$(e.currentTarget).parents(".seasonEpisodes").find(".episodeItem").each(function(e,t){o.watch.add($(t).attr("data-id"),t)})})},render:function(){$("#list").html("");var r=o.watch.list();store.forEach(function(e,t){if("M"==e.charAt(0)){var n=0,a=0,i={media:{id:t.id,name:t.name,image:t.image,allSeasons:0,allEpisodes:0},seasons:$.map(t.seasons,function(t){return n++,{id:t.id,name:t.name,episodes:$.map(t.episodes,function(e){return a++,{id:e.id,name:e.name.replace(t.name,"").trim(),new:-1!==$.inArray(e.id,r),duration:o.number(e.duration)}})}})};i.media.allSeasons=o.number(n),i.media.allEpisodes=o.number(a),$("#list").append(Mustache.render(o.mediaTemplate,i))}})},watch:{list:function(){return store.get("W",[])},add:function(e,t){var n,a,i=1<arguments.length&&void 0!==t?t:null;store.set("W",(n=store.get("W",[]),a=e,n.push(Number(a)),$.unique(n))),i&&$(i).attr("data-type","unwatch").find(".icon").removeClass("has-text-link").addClass("has-text-success").find(".icon-new").removeClass("icon-new").addClass("icon-check")},remove:function(e,t){var n,a,i=1<arguments.length&&void 0!==t?t:null;store.set("W",(n=store.get("W",[]),a=e,$.grep(n,function(e){return Number(a)!=e}))),i&&$(i).attr("data-type","watch").find(".icon").removeClass("has-text-success").addClass("has-text-link").find(".icon-check").removeClass("icon-check").addClass("icon-new")}},addMedia:function(i){$.getJSON("media/list/"+i+"/details.js?"+Date.now(),function(n){var a=[];$.each(n.seasons,function(e,t){$.getJSON("media/list/"+i+"/"+t.id+".js?"+Date.now(),function(e){o.addSeasson(i,e),a.push(!0),a.length==n.seasons.length&&o.render()})})})},removeMedia:function(e){store.remove("M-"+e),o.render()},addSeasson:function(e,t){var n;store.set("M-"+e,((n=store.get("M-"+e,{id:e,name:o.data[e].name,image:o.data[e].image,seasons:{}})).seasons[t.id]={id:t.id,name:t.name,episodes:$.map(t.episodes,function(e){return{id:e.id,name:e.name,duration:e.duration}})},n)),iziToast.show({message:["' "+t.name+" '","آپدیت شد"].join(" ")})}};o.template(),iziToast.settings({theme:"dark",position:"bottomCenter",pauseOnHover:!1,progressBar:!1,animateInside:!1,rtl:!0}),$.ajaxSetup({error:function(){iziToast.show({message:"خطا تو ارتباط با سرور!"})}}),$.getJSON("media/list.js?"+Date.now(),function(e){$.each(e.list,function(e,t){o.data[t.id]=t}),$("#search").select2({placeholder:"' جستجو کنید '",multiple:!0,dir:"rtl",width:"1%",data:$.map(o.data,function(e){return{id:e.id,text:e.name}}),maximumSelectionLength:1,minimumInputLength:2,language:{noResults:function(){return"بدون نتیجه!"},maximumSelected:function(){return"فقط یک انتخاب!"},inputTooShort:function(){return"برای جستجو حداقل دو حرف لازمه!"}}}).on("select2:select",function(e){o.addMedia(e.params.data.id),$(".select2-container-active").removeClass("select2-container-active"),$(":focus").blur()}).on("select2:opening",function(){$("#search").val(null).trigger("change")})})})},{}]},{},[1]);